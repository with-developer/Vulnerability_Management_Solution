{% extends 'layout.html' %}

{% block content %}




<!--  ################### -->
<!--  Start first Section -->
<!--  ################### -->
<div class="overview shadow-sm p-3 mb-5 bg-body rounded" style="padding: 1rem;padding-top: 0;margin-top: 30px; margin-bottom:0 !important;">
    <!-- Tab Navigation -->
    <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="script-manager-tab" data-bs-toggle="tab" href="#script-manager"
                role="tab" aria-controls="script-manager" aria-selected="true">Script Manager</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="script-editor-tab" data-bs-toggle="tab" href="#script-editor" role="tab"
                aria-controls="script-editor" aria-selected="false">Script Editor</button>
        </li>
    </ul>

    <!-- Tab Content -->
    <div class="tab-content" id="myTabContent">
        <!-- Script Manager Section -->
        <div class="tab-pane fade show active" id="script-manager" role="tabpanel" aria-labelledby="script-manager-tab">
            <!-- Your existing content for Script Manager here... -->
            <div class="title" style="margin:0; padding: 15px 0 0 0;">
                <i class="uil uil-document-layout-right"></i>
                <span class="text">Script Manager</span>
            </div>
            <hr>
            <div style="display:flex;">
                <!-- Search Div Start -->
                <div class="d-flex justify-content-center">
                    <form class="row g-3">
                        <div class="col-auto">
                            <input class="form-control" type="text" placeholder="Search Policy"
                                aria-label="default input example"
                                style="width:45.3vw; border-radius: unset;margin-right:15px;background: #f9fbfd;">
                        </div>
                </div>

                <div class="input-group mb-3" style="width: fit-content;">
                    <select class="form-select" aria-label="Default select example"
                        style="border-radius: unset; padding: 0.70rem 1.8rem 0.6rem 0.75rem; font-size: 0.5rem;">
                        <option selected>OS</option>
                        <option value="1">Debian</option>
                        <option value="2">Centos</option>
                        <option value="3">Fedora</option>
                        <option value="4">Rocky</option>
                    </select>
                </div>
                <div class="input-group mb-3" style="width: fit-content; margin-right:auto;">
                    <select class="form-select" aria-label="Default select example"
                        style="border-radius: unset; padding: 0.70rem 1.8rem 0.6rem 0.75rem; font-size: 0.5rem;">
                        <option selected>Script Name</option>
                        <option value="1">상</option>
                        <option value="2">중</option>
                        <option value="3">하</option>
                    </select>
                </div>



                </form>
                <!-- Search Div End -->
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap" style="margin-right:1rem;">
                    <div class="btn-toolbar mb-2 mb-md-0">
                        <div>
                            <button type="button" class="btn btn-primary" data-bs-toggle="modal"
                                data-bs-target="#exampleModal" style="border-radius: unset;">Import Script</button>
                            <!-- Button trigger modal -->
                        </div>
                    </div>
                </div>
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap" sytle="margin-right:auto;">
                    <div class="btn-toolbar mb-2 mb-md-0">
                        <div>
                            <button type="button" class="btn btn-primary" data-bs-toggle="modal"
                                data-bs-target="#exampleModal" style="border-radius: unset;">Export Script</button>
                            <!-- Button trigger modal -->
                        </div>
                    </div>
                </div>
            </div>

            <div>
                <table class="table table-sm">
                    <thead>
                        <tr>
                            <th scope="col" style="text-align: center;">OS</th>
                            <th scope="col" style="text-align: center;">Script Name</th>
                            <th scope="col" style="text-align: center;">Last Modified</span></th>
                            <th scope="col" style="text-align: center;">Modified By</th>
                            <th scope="col" style="text-align: center;">File Size</th>
                            <th scope="col" style="text-align: center;">File Hash</th>
                            <th scope="col" style="text-align:center;">Actions</th>
                        </tr>
                    </thead>
                    <tbody style="font-size:0.8rem;vertical-align: middle;">
                        {% for os_type, script_data in scripts.items() %}
                        {% for script in script_data %}
                        <tr>
                            {% if loop.first %}
                            <th scope="row" rowspan="{{ script_data|length }}" style="text-align: center;">{{ os_type }}
                            </th>
                            {% endif %}
                            <td style="text-align: center;">{{ script.name }}</td>
                            <td style="text-align: center;">{{ script.last_modified }}</td>
                            <td style="text-align: center;">admin</td>
                            <td style="text-align: center;">{{ script.size }} bytes</td>
                            <td style="text-align: center;"> {{ script.md5 }}</td>
                            <td style="text-align:center;">
                                <div class="btn-group">
                                    <button type="button" class="btn btn-info btn-sm" data-bs-toggle="dropdown"
                                        aria-expanded="false" style="background-color: transparent; border: none;">
                                        <i class="uil uil-ellipsis-h"></i>
                                    </button>
                                    <ul class="dropdown-menu dropdown-menu-end">
                                        <li><a class="dropdown-item view-script" href="#" data-os-type="{{ os_type }}"
                                                data-script-name="{{ script.name }}">View Script</a></li>
                                        <li><a class="dropdown-item edit-script" href="#" data-os-type="{{ os_type }}"
                                                data-script-name="{{ script.name }}">Edit Script</a></li>
                                        <li><a class="dropdown-item rename-script" href="#" data-os-type="{{ os_type }}"
                                                data-script-name="{{ script.name }}">Rename Script</a></li>
                                        <li><a class="dropdown-item delete-script" href="#" data-os-type="{{ os_type }}"
                                                data-script-name="{{ script.name }}">Delete Script</a></li>
                                    </ul>
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                        {% endfor %}
                    </tbody>
                </table>


            </div>
            <!-- ############ -->
            <!-- Secction End -->
            <!-- ############ -->

        </div>

        <!-- Script Editor Section -->

<div class="tab-pane fade" id="script-editor" role="tabpanel" aria-labelledby="script-editor-tab">
    <!--  #################### -->
    <!--  Start Second Section -->
    <!--  #################### -->


       <!-- Editor Container -->
       <div class="editor-container shadow-lg" style="margin-top:1rem;">
        <!-- File Explorer -->
        <div class="file-explorer">
            <div class="file-explorer-top" style="border-bottom: 1px solid #ddd;">
                <i class="uil uil-document-layout-right" style="position: relative;height: 35px;width: 35px;background-color: var(--primary-color);border-radius: 6px;color: var(--title-icon-color);display: inline-flex;align-items: center;justify-content: center;font-size: 24px;"></i>
                <span class="text" style="font-size: 24px;font-weight: 500;color: var(--text-color);margin-left: 10px;">Script Editor</span>
            </div>
            <div class="accordion" id="fileAccordion">
                <div style="font-size: 0.7rem !important;padding-bottom: 0 !important;font-weight: bolder !important;padding-left: 0.4rem !important; padding-top: 10px !important;">File Explorer</div>
                <!-- Script files will be populated dynamically -->
            </div>
            <hr style="margin: 1rem 0 0;"> <!-- Divider between scripts and policies -->

            <!-- Policies will be populated dynamically -->
            <div class="accordion" id="policyContainer">
                <div style="font-size: 0.7rem !important;padding-bottom: 0 !important;font-weight: bolder !important;padding-left: 0.4rem !important; padding-top: 10px !important;">Policy Explorer</div>
                <a href="#" id="resetPolicyNum" style="color: #555; text-decoration: none; font-size: 0.5rem !important; padding-left: 1.3rem;">All policies</a>
                {% set category_records = {} %}
                {% for policy in policies %}
                    {% set category_records = category_records.setdefault(policy.category, []) %}
                    {% set _ = category_records.append(policy) %}
                {% endfor %}
            
                {% for category, policy_records in category_records.items() %}
                    <div>
                        <div>
                            <button class="btn btn-block text-left os-type-button policy-category-button" type="button" data-bs-toggle="collapse" data-bs-target="#{{ category|replace(' ', '_') }}">
                                <i class="arrow-icon uil uil-angle-right"></i>
                                <i class="uil uil-folder"></i>
                                {{ category }}
                            </button>
                        </div>
                        <div class="collapse" id="{{ category|replace(' ', '_') }}">
                            <div class="card-body">
                                <ul>
                                    {% for policy_record in policy_records %}
                                        <li>
                                            <!-- data-policy-num 속성을 추가하여 해당 정책의 policy_num 값을 저장 -->
                                            <a href="#" class="file-name-link" data-policy-num="{{ policy_record.policy_num }}">{{ policy_record.policy_num }}. {{ policy_record.policy_name }}</a>
                                        </li>
                                    {% endfor %}
                                </ul>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    
    <!-- Main Editor Area -->
    <div class="editor-main">
        <!-- Current File Name -->
        <div style="background:#f5f5f5; display:flex; border-bottom: 1px solid #ddd;">
            <div class="current-file-name" style="font-size:0.7rem; height:30px; padding:5px 10px;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20"><path d="M9.25 12a.75.75 0 0 1-.22.53l-2.75 2.75a.75.75 0 0 1-1.06-1.06L7.44 12 5.22 9.78a.75.75 0 1 1 1.06-1.06l2.75 2.75c.141.14.22.331.22.53Zm2 2a.75.75 0 0 0 0 1.5h5a.75.75 0 0 0 0-1.5h-5Z"></path><path d="M0 4.75C0 3.784.784 3 1.75 3h20.5c.966 0 1.75.784 1.75 1.75v14.5A1.75 1.75 0 0 1 22.25 21H1.75A1.75 1.75 0 0 1 0 19.25Zm1.75-.25a.25.25 0 0 0-.25.25v14.5c0 .138.112.25.25.25h20.5a.25.25 0 0 0 .25-.25V4.75a.25.25 0 0 0-.25-.25Z"></path></svg>
                <span id="currentFileName">Select a file from the explorer</span>
            </div>
        </div>
        <div style="background:#ffffff; display:flex; border-bottom: none; height:18px;">
            <div class="current-file-name" style="border-right: none; font-size:0.7rem; padding:0px 10px;">
                <span id="currentPath">OS Type > File Name > Policy Category > Policy Name</span>
            </div>
        </div>
        <div style="height: 100% !important;">
        <!-- Monaco Editor Placeholder -->
        <div id="monacoEditor" style="height:100% !important;"></div>
    </div>
</div>

    <!-- ################### -->
    <!-- Second Secction End -->
    <!-- ################### -->

</div>


    </div>

</div>

<script>
    let editor;
    let policyNum;
    let osType;
    let scriptName;
    let policyCategory;
    let policyName;

    function updateCurrentPath() {
        let path = "Select a file from the explorer";
        
        if (osType && scriptName) {
            if (policyNum) {
                path = `/${osType}/${scriptName}/${policyCategory}/${policyNum}. ${policyName}`;
            } else {
                path = `/${osType}/${scriptName}/All Policies`;
            }
        }
    
        document.getElementById('currentPath').textContent = path;
    }


    require.config({ paths: { 'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.41.0/min/vs' } });
    require(['vs/editor/editor.main'], function() {
        editor = monaco.editor.create(document.getElementById('monacoEditor'), {
            value: "#!/bin/bash\n\n#In the left tab, select File, Policy.\n#If you do not set a policy, all items are printed.",
            language: "shell",
            theme: "tomorrow",
            vertical: 'auto',
            horizontal: 'auto',
            verticalScrollbarSize: 10,
            horizontalScrollbarSize: 10,
            scrollBeyondLastLine: false, // 에디터상에서 스크롤이 가능하게
            readOnly: false,    // 수정 가능 여부
            automaticLayout: true, // 부모 div 크기에 맞춰서 자동으로 editor 크기 맞춰줌

            fontSize: 14,
            minimap: {
                enabled: true // 우측 스크롤 미니맵
            },
            lineHeight: 19
        });
        let parent = document.getElementById("monacoEditor").parentElement;
        console.log(parent.clientWidth)

    function populateFileExplorer() {
        $.ajax({
            type: "GET",
            url: "/api/get_script_filename",
            success: function(response) {
                if (response.result === "success") {
                    const accordion = document.getElementById('fileAccordion');
                    const scripts = response.data;
                    let osTypeCounter = 0;
    
                    for (const osTypeName in scripts) {
                        osTypeCounter++;


    
                        const card = document.createElement('div');
                        const cardHeader = document.createElement('div');
    
                        const btn = document.createElement('button');
                        const arrowIcon = document.createElement('i');
                        arrowIcon.className = 'arrow-icon uil uil-angle-right';
                        btn.appendChild(arrowIcon);

                        btn.className = 'btn btn-block text-left os-type-button'; // Added class for OS type
                        btn.type = 'button';
                        btn.setAttribute('data-bs-toggle', 'collapse');
                        btn.setAttribute('data-bs-target', `#collapse${osTypeCounter}`);

                        // 아이콘 추가
                        const icon = document.createElement('i');
                        icon.className = 'uil uil-folder';
                        btn.appendChild(icon);  // Add the icon to the button

                        // Add a space between the icon and the OS name
                        const space = document.createTextNode(' ');
                        btn.appendChild(space);

                        // Add the OS name
                        btn.appendChild(document.createTextNode(osTypeName));

                        cardHeader.appendChild(btn);
                        card.appendChild(cardHeader);
    
                        const collapse = document.createElement('div');
                        collapse.id = `collapse${osTypeCounter}`;
                        collapse.className = 'collapse';
                        collapse.setAttribute('data-parent', '#fileAccordion');
    
                        const cardBody = document.createElement('div');
                        cardBody.className = 'card-body';
    
                        const ul = document.createElement('ul');
    
                        scripts[osTypeName].forEach(file => {
                            const li = document.createElement('li');
                            const a = document.createElement('a');
                            a.href = '#';
                            a.className = 'file-name-link'; // Added class for file name
                        
                            // Terminal SVG icon 추가
                            const fileIcon = document.createElementNS("http://www.w3.org/2000/svg", "svg");
                            fileIcon.setAttribute("viewBox", "0 0 16 16");
                            fileIcon.setAttribute("width", "14");
                            fileIcon.setAttribute("height", "14");

                            const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
                            path.setAttribute("d", "M0 2.75C0 1.784.784 1 1.75 1h12.5c.966 0 1.75.784 1.75 1.75v10.5A1.75 1.75 0 0 1 14.25 15H1.75A1.75 1.75 0 0 1 0 13.25Zm1.75-.25a.25.25 0 0 0-.25.25v10.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V2.75a.25.25 0 0 0-.25-.25ZM7.25 8a.749.749 0 0 1-.22.53l-2.25 2.25a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L5.44 8 3.72 6.28a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215l2.25 2.25c.141.14.22.331.22.53Zm1.5 1.5h3a.75.75 0 0 1 0 1.5h-3a.75.75 0 0 1 0-1.5Z");

                            fileIcon.appendChild(path);
                            a.appendChild(fileIcon);  // Add the terminal SVG icon to the link

                        
                            // Add a space between the icon and the file name
                            const fileSpace = document.createTextNode(' ');
                            a.appendChild(fileSpace);
                        
                            // Add the file name
                            a.appendChild(document.createTextNode(file.name));
                            
                            a.dataset.osType = osTypeName;
                        
                            a.addEventListener('click', function(e) {
                                e.preventDefault();
                                osType = e.target.dataset.osType;       // 전역 변수에 값을 할당
                                scriptName = e.target.textContent.trim(); // 전역 변수에 값을 할당
                                document.getElementById('currentFileName').textContent = `/${osType}/${scriptName}`;
                            
                                updateCurrentPath();

                                // 2. API 호출을 사용하여 스크립트 내용 가져오기
                                $.get(`/api/get_script_content_policy_num?os_type=${osType}&file_name=${scriptName}&policy_num=${policyNum}`, function(response) {
                                    // 3. 스크립트 내용을 Monaco editor에 로드
                                    if (response.result === "success") {
                                        editor.setValue(response.data);
                                    } else {
                                        alert('Error loading the script: ' + response.message);
                                    }
                                }).fail(function() {
                                    alert('Error loading the script.');
                                });
                            });
                        
                            li.appendChild(a);
                            ul.appendChild(li);
                        });
    
                        cardBody.appendChild(ul);
                        collapse.appendChild(cardBody);
                        card.appendChild(collapse);
                        accordion.appendChild(card);
                    }
                } else {
                    alert(response.message);
                }
            },
            // ... (the rest of your AJAX error handling and other codes)
        });
    }
    
    // Initialize on page load
    populateFileExplorer();
    
    $(document).on('show.bs.collapse', '.collapse', function () {
        const arrowIcon = this.previousElementSibling.querySelector('.arrow-icon');
        if (arrowIcon) {
            arrowIcon.classList.remove('uil-angle-right');
            arrowIcon.classList.add('uil-angle-down');
        }
    });

    $(document).on('hide.bs.collapse', '.collapse', function () {
        const arrowIcon = this.previousElementSibling.querySelector('.arrow-icon');
        if (arrowIcon) {
            arrowIcon.classList.remove('uil-angle-down');
            arrowIcon.classList.add('uil-angle-right');
        }
    });
});
document.querySelectorAll('.file-name-link').forEach(link => {
    link.addEventListener('click', function(e) {
        e.preventDefault();
        policyNum = e.target.dataset.policyNum;
        policyName = e.target.textContent.split('.')[2].trim();
        policyCategory = e.target.closest('.collapse').previousElementSibling.textContent.trim();

        console.log(policyNum);
        console.log(osType);
        console.log(scriptName);

        // osType과 scriptName이 모두 값이 있을 때만 API 호출
        if (osType && scriptName) {
            document.getElementById('currentFileName').textContent = `/${osType}/${scriptName}`;

            updateCurrentPath();
            
            // 2. API 호출을 사용하여 스크립트 내용 가져오기
            $.get(`/api/get_script_content_policy_num?os_type=${osType}&file_name=${scriptName}&policy_num=${policyNum}`, function(response) {
                // 3. 스크립트 내용을 Monaco editor에 로드
                if (response.result === "success") {
                    editor.setValue(response.data);
                } else {
                    alert('Error loading the script: ' + response.message);
                }
            }).fail(function() {
                alert('Error loading the script.');
            });
        }
    });
});

// Reset PolicyNum 버튼 클릭 이벤트 처리
document.getElementById('resetPolicyNum').addEventListener('click', function() {
    policyNum = undefined;
    policyName = undefined;
    policyCategory = undefined;
    updateCurrentPath();

    // 2. API 호출을 사용하여 스크립트 내용 가져오기
    $.get(`/api/get_script_content_policy_num?os_type=${osType}&file_name=${scriptName}&policy_num=${policyNum}`, function(response) {
        // 3. 스크립트 내용을 Monaco editor에 로드
        if (response.result === "success") {
            editor.setValue(response.data);
        } else {
            alert('Error loading the script: ' + response.message);
        }
    }).fail(function() {
        alert('Error loading the script.');
    });
});

    
</script>



<!-- View Script Modal Start -->
<div class="modal fade" id="scriptModal" tabindex="-1" aria-labelledby="scriptModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" style="max-width: 65%;">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="scriptModalLabel">View Script</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <pre style="max-height:400px; overflow-y:auto;"><code id="scriptContent" class="bash"></code></pre>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<!-- View Script Modal End -->

<!-- Edit Script Modal Start -->
<div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" style="max-width: 65%;">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editModalLabel">Edit Script</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div id="editor" style="height: 400px;"></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" id="saveButton" class="btn btn-primary">Save</button>
            </div>
        </div>
    </div>
</div>
<!-- Edit Script Modal End -->

<!-- Rename Script Modal Start -->
<div class="modal fade" id="renameModal" tabindex="-1" aria-labelledby="renameModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="renameModalLabel">Rename Script</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <label for="newScriptName">New Script Name:</label>
                <input type="text" class="form-control" id="newScriptName">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" id="renameSaveButton" class="btn btn-primary">Save</button>
            </div>
        </div>
    </div>
</div>
<!-- Rename Script Modal End -->

<!-- View Script Ajax Start -->
<script>
    $(document).ready(function () {
        $(".view-script").click(function (e) {
            e.preventDefault();

            // Get file path from the `data-*` attributes
            var osType = $(this).data("os-type");
            var scriptName = $(this).data("script-name");

            // AJAX call to get script content
            $.ajax({
                type: "GET",
                url: "/api/get_script",
                data: {
                    os_type: osType,
                    script_name: scriptName
                },
                success: function (response) {
                    // Insert script content into the modal and show it
                    $("#scriptContent").text(response);
                    hljs.highlightBlock(document.getElementById("scriptContent"));
                    $("#scriptModal").modal("show");

                },
                error: function (error) {
                    alert("Error fetching script.");
                }
            });
        });
    });
</script>
<!-- View Script Ajax End -->

<!-- Edit Script Ajax Start -->

<!-- Edit Script Ajax End -->

<!-- Rename Script Ajax Start -->
<script>
    $(document).ready(function () {
        let renameOsType = "";
        let renameScriptName = "";

        $(".rename-script").click(function (e) {
            e.preventDefault();

            // Get current script information from the `data-*` attributes
            renameOsType = $(this).data("os-type");
            renameScriptName = $(this).data("script-name");

            // Show the rename modal
            $("#newScriptName").val(renameScriptName); // Set current script name as default
            $("#renameModal").modal("show");
        });

        $("#renameSaveButton").click(function () {
            let newScriptName = $("#newScriptName").val();

            if (newScriptName.trim() === "") {
                alert("Script name cannot be empty.");
                return;
            }

            // AJAX request to rename the script
            $.ajax({
                type: "POST",
                url: "/api/rename_script",
                data: {
                    os_type: renameOsType,
                    old_script_name: renameScriptName,
                    new_script_name: newScriptName
                },
                success: function (response) {
                    if (response.result === "success") {
                        $("#renameModal").modal("hide");
                        Swal.fire({
                            icon: 'success',
                            title: 'Renamed!',
                            text: response.message
                        }).then(function () {
                            $("#script-tab").click();
                        });
                    } else {
                        Swal.fire({
                            icon: 'error',
                            title: 'Oops...',
                            text: response.message
                        });
                    }
                },
                error: function (error) {
                    Swal.fire({
                        icon: 'error',
                        title: 'Oops...',
                        text: 'Error renaming script.'
                    });
                }
            });
        });
    });
</script>
<!-- Rename Script Ajax End -->

<!-- Delete Script Ajax Start -->
<script>
    $(document).ready(function () {
        $(".delete-script").click(function (e) {
            e.preventDefault();

            // Get file path from the `data-*` attributes
            var osType = $(this).data("os-type");
            var scriptName = $(this).data("script-name");

            Swal.fire({
                title: 'Are you sure?',
                text: `Do you want to delete '${scriptName}'?`,
                icon: 'warning',
                showCancelButton: true,
                confirmButtonText: 'Yes, delete it!',
                cancelButtonText: 'No, keep it'
            }).then((result) => {
                if (result.isConfirmed) {
                    $.ajax({
                        type: "POST",
                        url: "/api/delete_script",
                        data: {
                            os_type: osType,
                            script_name: scriptName
                        },
                        success: function (response) {
                            if (response.result === "success") {
                                Swal.fire({
                                    icon: 'success',
                                    title: 'Deleted!',
                                    text: response.message
                                }).then(function () {
                                    $("#script-tab").click();
                                });
                            } else {
                                Swal.fire({
                                    icon: 'error',
                                    title: 'Oops...',
                                    text: response.message
                                });
                            }
                        },
                        error: function (error) {
                            Swal.fire({
                                icon: 'error',
                                title: 'Oops...',
                                text: 'Error deleting script.'
                            });
                        }
                    });
                }
            });
        });
    });
</script>
<!-- Delete Script Ajax End -->

<!-- ############################### -->
<!-- Second Section Javascript Start -->
<!-- ############################### -->



<!-- ############################# -->
<!-- Second Section Javascript END -->
<!-- ############################# -->

{% endblock %}