{% extends 'layout.html' %}
 
{% block content %}

<!--  ################### -->
<!--  Start first Section -->
<!--  ################### -->
<div class="overview shadow-sm p-3 mb-5 bg-body rounded" style="padding: 1rem;padding-top: 0;margin-top: 30px;">
    <div class="title" style="margin:0; padding: 15px 0 0 0;">
        <i class="uil uil-servers"></i>
        <span class="text">Remote Manager</span>
    </div>
    <hr>
    <div style="display:flex;">
        <!-- Search Div Start -->
        <div class="d-flex justify-content-center">
          <form class="row g-3">
              <div class="col-auto">
                <input class="form-control" type="text" placeholder="Search Agent" aria-label="default input example" style="width:48.3vw; border-radius: unset;margin-right:15px;background: #f9fbfd;">
              </div>
        </div>
  
        <div class="input-group mb-3" style="width: fit-content;">
          <select class="form-select" aria-label="Default select example" style="border-radius: unset; padding: 0.70rem 1.8rem 0.6rem 0.75rem; font-size: 0.5rem;">
            <option selected>Category</option>
            <option value="1">계정관리</option>
            <option value="2">파일 및 디렉토리 관리</option>
            <option value="3">서비스 관리</option>
            <option value="4">로그 관리</option>
          </select>
        </div>
        <div class="input-group mb-3" style="width: fit-content;">
          <select class="form-select" aria-label="Default select example" style="border-radius: unset; padding: 0.70rem 1.8rem 0.6rem 0.75rem; font-size: 0.5rem;">
            <option selected>Risk</option>
            <option value="1">상</option>
            <option value="2">중</option>
            <option value="3">하</option>
          </select>
        </div>
        
  
        
      </form>
      <!-- Search Div End -->
      <div class="d-flex justify-content-between flex-wrap flex-md-nowrap">
        <div class="btn-toolbar mb-2 mb-md-0">
          <div>
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal" style="border-radius: unset;">Connect Agent</button>
            <!-- Button trigger modal -->
          </div>
        </div>
      </div>
    </div>
  
    <div>
        <table class="table table-sm">
            <thead>
                <tr>
                  <th scope="col">#</th>
                  <th scope="col">Category</th>
                  <th scope="col">Name</th>
                  <th scope="col">Risk</th>
                  <th scope="col">Action</th>
                </tr>
              </thead>
              {% set start_index = (current_page - 1) * 10 %}
              <tbody style="font-size:0.8rem;vertical-align: middle;">
                {% for policy in policies %}
                <tr style="border-bottom:hidden">
                  <th scope="row">{{ policy.policy_num }}</th>
                  <td>{{ policy.category }}</td>
                  <td>{{ policy.policy_name }}</td>
                  <td rowspan="2" style="border-color: lightgray;">{{ policy.risk }}</td>
                  <td rowspan="2" style="border-color: lightgray;">
                    <!-- Actions: you can customize as required -->
                    <div class="btn-group">
                        <button type="button" style="font-size: 0.5rem" class="btn btn-info btn-sm dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                            Actions
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="#">Action 1</a></li>
                            <li><a class="dropdown-item" href="#">Action 2</a></li>
                        </ul>
                    </div>
                  </td>
                </tr>
                <tr style="border-top: hidden;">
                  <td></td>
                  <td></td>
                  <td style="color: gray; font-size:0.7rem; padding-top:0;">{{ policy.standard }}</td>
                  <td></td>
                </tr>
                {% set start_index = start_index + 1 %}
                {% endfor %}
            </tbody>
        </table>
        <div style="font-size: 0.7rem;color: grey;">
            showing {{ start_entry }} to {{ end_entry }} of {{ total_policies }} entries
  
            <div class="pagination" style="position: inherit;">
                {% if current_page > 1 %}
                <a href="{{ url_for('policy_manager.dashboard', page=1) }}" title="first page" style="height: fit-content;padding-top: 0.3rem;padding-bottom: 0.3rem;">First</a>
                <a href="{{ url_for('policy_manager.dashboard', page=current_page-1) }}" title="previous page" style="height: fit-content;padding-top: 0.3rem;padding-bottom: 0.3rem;">Prev</a>
                {% endif %}
  
                {% for page_num in range(1, total_pages+1) %}
                {% if page_num == current_page %}
                <a href="{{ url_for('policy_manager.dashboard', page=page_num) }}" class="page-active" style="height: fit-content;padding-top: 0.3rem;padding-bottom: 0.3rem;">{{ page_num }}</a>
                {% else %}
                <a href="{{ url_for('policy_manager.dashboard', page=page_num) }}" style="height: fit-content;padding-top: 0.3rem;padding-bottom: 0.3rem;">{{ page_num }}</a>
                {% endif %}
                {% endfor %}
  
                {% if current_page < total_pages %}
                <a href="{{ url_for('policy_manager.dashboard', page=current_page+1) }}" title="next page" style="height: fit-content;padding-top: 0.3rem;padding-bottom: 0.3rem;">Next</a>
                <a href="{{ url_for('policy_manager.dashboard', page=total_pages) }}" title="last page" style="height: fit-content;padding-top: 0.3rem;padding-bottom: 0.3rem;">Last</a>
                {% endif %}
            </div>
        </div>
        
    </div>
  </div>
  
  {% endblock %}