{% extends 'layout.html' %}

{% block content %}


    
    <h2 style="margin-top: 1rem; margin-bottom: 1rem;">Management Panel</h2>
    <div class="table-responsive small">

        <!-- tabs start -->
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
              <button class="nav-link active" id="agents-tab" data-bs-toggle="tab" data-bs-target="#agents" type="button" role="tab" aria-controls="agents" aria-selected="true">Agents Manager</button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="script-tab" data-bs-toggle="tab" data-bs-target="#script" type="button" role="tab" aria-controls="script" aria-selected="false">Script Manager</button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="users-tab" data-bs-toggle="tab" data-bs-target="#users" type="button" role="tab" aria-controls="users" aria-selected="false">Users Manager</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="schedule-tab" data-bs-toggle="tab" data-bs-target="#schedule" type="button" role="tab" aria-controls="schedule" aria-selected="false">Schedule Manager</button>
            </li>
          </ul>

        <!-- tabs end -->
        <div class="tab-content" id="myTabContent" style="width:99%">
            <div class="tab-pane fade" id="agents" role="tabpanel" aria-labelledby="agents-tab"></div>
            <div class="tab-pane fade" id="script" role="tabpanel" aria-labelledby="script-tab"></div>
            <div class="tab-pane fade" id="users" role="tabpanel" aria-labelledby="users-tab"></div>
            <div class="tab-pane fade" id="schedule" role="tabpanel" aria-labelledby="schedule-tab"></div>
        </div>
        
        <!-- tabs ajax start -->

        <script>
            $(document).ready(function() {
                function loadTabContent(tabElement) {
                    let targetUrl = '';
                    let targetDiv = '';
                    
                    if (tabElement.attr('id') === 'agents-tab') {
                        targetUrl = '/admin/load_agents';
                        targetDiv = '#agents';
                    } else if (tabElement.attr('id') === 'script-tab') {
                        targetUrl = '/admin/load_script';
                        targetDiv = '#script';
                    } else if (tabElement.attr('id') === 'users-tab') {
                        targetUrl = '/admin/load_users';
                        targetDiv = '#users';
                    } else if (tabElement.attr('id') == 'schedule-tab') {
                        targetUrl = '/admin/load_schedule';
                        targetDiv = '#schedule';
                    }
                    
                    $.ajax({
                        url: targetUrl,
                        type: 'GET',
                        success: function(response) {
                            $('#myTabContent .tab-pane').removeClass('show active'); // 모든 탭의 내용을 숨깁니다.
                            $(targetDiv).html(response).addClass('show active'); // AJAX로 가져온 내용을 해당 탭에 표시하고 활성화합니다.
                        },
                        error: function(error) {
                            console.log(error);
                        }
                    });
                    
                    // 모든 탭의 active 상태를 삭제
                    $('#myTab .nav-link').removeClass('active');
                    // 현재 클릭된 탭을 active 상태로 설정
                    tabElement.addClass('active');
                }
                
                // Click event for all tabs
                $('#myTab button').on('click', function(e) {
                    e.preventDefault();
                    loadTabContent($(this));
                });
        
                // Automatically load the home-tab content on page load
                loadTabContent($('#agents-tab'));
            });
        </script>

        <!-- tabs ajax end -->


    </div>



{% endblock %}