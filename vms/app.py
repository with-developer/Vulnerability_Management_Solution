from flask import Flask, render_template, jsonify, request, session, redirect, url_for, current_app
from pymongo import MongoClient
from views.user import bp as user
from views.admin import bp as admin
from views.dashboard import bp as dashboard


app = Flask(__name__)
app.register_blueprint(user)
app.register_blueprint(admin)
app.register_blueprint(dashboard)

@app.before_first_request
def init_app():
    client = MongoClient('mongodb://root:test@mongodb:27017/?authMechanism=DEFAULT')
    current_app.db = client.VMS

if __name__ == '__main__':
    app.run(host='0.0.0.0',port=80, debug=True)
    